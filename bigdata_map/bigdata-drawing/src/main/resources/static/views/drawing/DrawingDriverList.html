<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>秦皇岛市智慧交通北斗大数据分析平台</title>
<link href="css/animate.min.css" rel="stylesheet" type="text/css">
<link href="css/layout.css" rel="stylesheet" type="text/css" />
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="font/iconfont.css" rel="stylesheet" type="text/css" />
<link href="css/layer-animate.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="css/datedropper.css">
<link rel="stylesheet" type="text/css" href="css/timedropper.min.css">
    <script src="js/tool.js"></script>
</head>

<body>

<div class="top" >
    <div class="top_r">
        <div class="time">
                
                   
                <!--<input type="text" class="input_rl " id="pickdate" style="width:150px; height: 48px; margin-right: 10px; " /> -->
				<span id=localtime></span>
                <script type="text/javascript">
					function showLocale(objD){
						var str,colorhead,colorfoot;
						var yy = objD.getYear();
						if(yy<1900) yy = yy+1900;
						var MM = objD.getMonth()+1;
						if(MM<10) MM = '0' + MM;
						var dd = objD.getDate();
						if(dd<10) dd = '0' + dd;
						var hh = objD.getHours();
						if(hh<10) hh = '0' + hh;
						var mm = objD.getMinutes();
						if(mm<10) mm = '0' + mm;
						var ss = objD.getSeconds();
						if(ss<10) ss = '0' + ss;
						var ww = objD.getDay();
						if  ( ww==0 )  colorhead="<font color=\"#35afbd\">";
						if  ( ww > 0 && ww < 6 )  colorhead="<font color=\"#35afbd\">";
						if  ( ww==6 )  colorhead="<font color=\"#35afbd\">";
						if  (ww==0)  ww="星期日";
						if  (ww==1)  ww="星期一";
						if  (ww==2)  ww="星期二";
						if  (ww==3)  ww="星期三";
						if  (ww==4)  ww="星期四";
						if  (ww==5)  ww="星期五";
						if  (ww==6)  ww="星期六";
						colorfoot="</font>"
						str = colorhead + yy + "-" + MM + "-" + dd + " " + hh + ":" + mm + ":" + ss + "  " + ww + colorfoot;
						return(str);
					}
					
					function tick(){
						var today;
						today = new Date();
						document.getElementById("localtime").innerHTML = showLocale(today);
						window.setTimeout("tick()", 1000);
					}
					
					tick();
					</script>	
        </div>
    </div>
    <div class="top_l">
    
        <div class="bt">
             <div class="bt_name left">从业人员</div>
             <a href="../bigdata/shouye.html" class="fanhui"><i class="iconfont icon-fanhui"></i></a>
        </div>
      
    </div>

    <div class="top_m "><div class="logo" onclick="goShouYe();"style="cursor:pointer">秦皇岛市智慧交通北斗大数据分析平台</div></div>
</div>












<div class="main">
      <div class="ind">
          <div class="blank40"></div>          
          <div class="mk " style="width:20%; height:900px; float:left">
               <em class="b1"></em><em class="b2"></em><em class="b3"></em><em class="b4"></em><em class="mid"></em>
               <div class="blank20"></div>
               <div class="tit">
                     <span class="tit_l"></span>
                     <span class="tit_m">高级检索</span>
                     <span class="tit_r"></span>
               </div>
              <form id="searchEmpForm" action="" method="post">
               <div class="con0 clearfix">
                   <input type="hidden" name="cityId" value="130300"/>
                    <div class="mingcheng0">司机姓名</div>
                    <div>
                        <input id="driverName" class="input" name="driverName" type="text" />
                    </div>
                    <div class="blank10"></div>
                    <div class="mingcheng0">所属企业</div>
                    <div>
                        <input id="teamName" class="input" name="teamName" type="text" />
                    </div>
                   <!-- <div class="blank10"></div>
                    <div class="mingcheng0">人员类型</div>
                    <div class="mingcheng0">
                        <select id="empType" name="empType" class="input00" style="height: 50px">
                            <option class="lsd" value ="">请选择</option>
                            <option class="lsd" value="1">驾驶员</option>
                            <option class="lsd" value="2">押运员</option>
                            <option class="lsd" value ="3">装卸员</option>
                            <option class="lsd" value="4">经理</option>
                            <option class="lsd" value="5">财务</option>
                            <option class="lsd" value="6">业务</option>
                            <option class="lsd" value="7">内勤</option>
                            <option class="lsd" value ="0">其他</option>
                        </select>
                    </div>-->
                    <div class="blank10"></div>
                    <div class="mingcheng0">车牌号</div>
                    <div>
                        <input id="carPlateNum" class="input" name="carPlateNum" type="text" />
                    </div>
                    <div class="mingcheng0">手机号</div>
                    <div>
                        <input id="driverPhone" class="input" name="driverPhone" type="text" />
                    </div>
                    <div class="mingcheng0">身份证号</div>
                    <div>
                        <input id="driverIdCard" class="input" name="driverIdCard" type="text" />
                    </div>
                    
                    <div class="blank20"></div>
                    <div class="center">
                      <a href="###" class="clss " onclick="searchEmpListForm()"><i class="iconfont icon-sousuo5 " style="font-size:20px"></i>&nbsp;搜索</a>
                    </div>
               </div>
              </form>
           </div> 
          
          
          
          <div class="mk " style="width:79%; height:900px; float:right">
               <em class="b1"></em><em class="b2"></em><em class="b3"></em><em class="b4"></em>
               <div class="blank20"></div>
               <div class="con0 clearfix">
                   <div  style="height:850px; overflow-y: auto">
                              <table  width="100%" class="grid06">
                                  <tr>
                                    <th style="width:10%">姓名</th>
                                      <th style="width:10%">所属县区</th>
                                    <th style="width:10%">性别</th>
                                    <th style="width:10%">人员身份</th>
                                    <th style="width:10%">手机号</th>
                                    <th style="width:17%">资格证号</th>
                                    <th style="width:10%">车牌号</th>
                                    <th style="width:10%">入职日期</th>
                                    <th style="width:13%">健康信息</th>
                                  </tr>
                               </table>
                               <table id="empList" width="100%" class="grid06">

                               </table>
                       
                        <div class="blank20"></div>
                       
                       
                             <div id="pageList" class="green-black">
                                    <!--<span class="disabled">&lt; Prev</span>
                                    <span class="current">1</span>
                                    <a href="#?page=2">2</a>
                                    <a href="#?page=3">3</a>
                                    <a href="#?page=4">4</a>
                                    <a href="#?page=5">5</a>
                                    <a href="#?page=6">6</a>
                                    <a href="#?page=7">7</a><em class="white">......</em>
                                    <a href="#?page=199">199</a>
                                    <a href="#?page=200">200</a>
                                    <a href="#?page=2">Next 
                                    &gt; </a>-->
                            </div> 
                    </div>
                </div>
          </div>
         
           
     </div>
</div>









<script src="js/jquery-1.8.3.min.js"></script>
<script src="js/jquery-migrate-1.2.1.min.js"></script>
<script src="js/echarts.min.js"></script>
<script src="js/tool.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script>
    $(function(){
        /*var queryArgs = getQueryParam();
        if(decodeURI(queryArgs.empName) != "undefined"){
            $("#empName").val(decodeURI(queryArgs.empName));
        }
        if(decodeURI(queryArgs.ownerCarTeamName) != "undefined"){
            $("#ownerCarTeamName").val(decodeURI(queryArgs.ownerCarTeamName));
        }
        if(decodeURI(queryArgs.empType) != "undefined"){
            $("#empType").val(decodeURI(queryArgs.empType));
        }

        //参数整理
        var param = "cityId=130300";
        var page = decodeURI(queryArgs.page);
        if(page != null && page != '' && page != "undefined"){
            param += "&page=" + page+"&limit=13";
        }else {
            param += "&page=1&limit=13";
        }
        var empName = decodeURI(queryArgs.empName);
        if(empName != null && empName != "undefined" && empName != ''){
            param += "&empName=";
            param += empName;
            $("#empName").val(empName);
        }
        var empPhone = decodeURI(queryArgs.empPhone);
        if(empPhone != null && empPhone != "undefined" && empPhone != ''){
            param += "&empPhone=";
            param += empPhone;
            $("#empPhone").val(empPhone);
        }
        var ownerCarTeamName = decodeURI(queryArgs.ownerCarTeamName);
        if(ownerCarTeamName != null && ownerCarTeamName != '' && ownerCarTeamName != "undefined"){
            param += "&ownerCarTeamName=";
            param += ownerCarTeamName;
            $("#ownerCarTeamName").val(ownerCarTeamName);
        }
        var empType = decodeURI(queryArgs.empType);
        if(empType != null && empType != '' && empType != "undefined"){
            param += "&empType=";
            param += empType;
            $("#empType").val(empType);
        }
        var carPlateNum = decodeURI(queryArgs.carPlateNum);
        if(carPlateNum != null && carPlateNum != '' && carPlateNum != "undefined"){
            param += "&carPlateNum=";
            param += carPlateNum;
            $("#carPlateNum").val(carPlateNum);
        }
        var empIdCard = decodeURI(queryArgs.empIdCard);
        if(empIdCard != null && empIdCard != '' && empIdCard != "undefined"){
            param += "&empIdCard=";
            param += empIdCard;
            $("#empIdCard").val(empIdCard);
        }*/
        //查询从业人员
        var queryArgs = getQueryParam();
        if(decodeURI(queryArgs.empName) != "undefined"){
            $("#driverName").val(decodeURI(queryArgs.empName));
        }
        if(decodeURI(queryArgs.ownerCarTeamName) != "undefined"){
            $("#teamName").val(decodeURI(queryArgs.ownerCarTeamName));
        }
        var driverName = $("#driverName").val();
        var teamName = $("#teamName").val();
        var param = {
            'queryObj.driverName':driverName,
            'queryObj.teamName':teamName,
            'page':1,
            'limit':13
        }
        searchEmpList(param);
    })

    function searchEmpList(queryArgs){
        $.ajax({
            type:'POST',
            url: basePathUrl + '/admin/bigdataDriverCardInfo/listpage.jsn',
            data:queryArgs,
            dataType:'json',
            beforeSend: function (XMLHttpRequest) {
                XMLHttpRequest.setRequestHeader("access-token", getStorage("access_token"));
            },
            success:function(data){
                if(data.success){
                    debugger;
                    var empList = data.list;
                    var html = "";
                    if(empList.length > 0){
                        for(var i=0;i<empList.length;i++){
                            html += "<tr style='cursor: pointer' onclick=gotoDetailPage('"+empList[i].id+"')>";
                            html += "<td width='10%'>"+empList[i].driverName+"</td>";
                            if(typeof (empList[i].xianquName)=='undefined'){
                                html += "<td width='10%'>暂无</td>";
                            }else {
                                html += "<td width='10%'>"+empList[i].xianquName+"</td>";
                            }
                            if(empList[i].driverSex != null){
                                html += "<td width='10%'>"+empList[i].driverSex+"</td>";
                            }else{
                                html += "<td width='10%'></td>";
                            }
                            html += "<td width='10%'>司机</td>"
                            html += "<td width='10%'>"+empList[i].driverPhone+"</td>";
                            html += "<td width='17%'>"+empList[i].driverCode+"</td>";
                            if(empList[i].carPlateNum != null){
                                html += "<td width='10%'>"+empList[i].carPlateNum+"</td>";
                            }else{
                                html += "<td width='10%'></td>";
                            }
                            if(empList[i].driverEntryDay != null && empList[i].driverEntryDay != ''){
                                html += "<td width='10%'>"+dateFormat("yyyy-MM-dd",new Date(empList[i].driverEntryDay))+"</td>";
                            }else{
                                html += "<td width='10%'>暂无</td>";
                            }
                            if(typeof(empList[i].healthMessage) != undefined && empList[i].healthMessage != null && empList[i].healthMessage != ''){
                                html += "<td width='13%'>"+empList[i].healthMessage+"</td>";
                            }else{
                                html += "<td width='13%'>请上传健康信息</td>";
                            }
                            html += "</tr>";
                        }
                        setPageInfo(data.totalPage,data.start,data.limit,data.totalCount);
                    }else{
                        html += "<tr><td colspan='8'>暂无信息</td></tr>";
                    }
                    $("#empList").html(html);
                }else{
                    if(data.code==1001){
                        location.href = '../../login.html';
                    }else {
                        alert("未查到相关信息！");
                    }
                }
            }
        })
    }

    function gotoDetailPage(id){
        window.location.href = "DrawingDriver.html?id="+id;
    }

    function searchEmpListForm(){
        var driverName = $("#driverName").val();
        var teamName = $("#teamName").val();
        var carPlateNum = $("#carPlateNum").val();
        var driverPhone = $("#driverPhone").val();
        var driverIdCard = $("#driverIdCard").val();
        var param = {
            'queryObj.driverName':driverName,
            'queryObj.teamName':teamName,
            'queryObj.carPlateNum':carPlateNum,
            'queryObj.driverPhone':driverPhone,
            'queryObj.driverIdCard':driverIdCard,
            'page':1,
            'limit':13
        }
        searchEmpList(param);
    }

    function setPageInfo(totalPage,start,limit,totalCount){
        var page = 0;
        if(limit != 0){
            page = start/limit;
        }
        var pageHtml = "";
        var showPageCount = page + 5;
        pageHtml += "<a href='javaScript:void(0);' onclick=sendRequest('prev',"+(page+1)+","+totalPage+")>&lt;上一页</a>";
        if(page>0){
            pageHtml += "<a href='javaScript:void(0);' onclick=sendRequest('',"+(1)+","+totalPage+")>首页</a>";
        }
        for(var i=page;i<totalPage;i++){
            if(i < showPageCount){
                if(i == page){
                    pageHtml += "<a href='javaScript:void(0);' style='background-color: #E07C24;border:none'  onclick=sendRequest('',"+(i+1)+","+totalPage+")>"+(i+1)+"</a>";
                }else{
                    pageHtml += "<a href='javaScript:void(0);' onclick=sendRequest('',"+(i+1)+","+totalPage+")>"+(i+1)+"</a>";
                }
            }else{
                if(i == showPageCount){
                    pageHtml += "<em class='white'>......</em>";
                    pageHtml += "<a href='javaScript:void(0);' onclick=sendRequest('',"+totalPage+","+totalPage+")>"+totalPage+"</a>";
                }
            }
        }
        pageHtml += "<a href='javaScript:void(0);' onclick=sendRequest('next',"+(page+1)+","+totalPage+")>下一页 &gt;</a>";
        pageHtml += "<a href='javaScript:void(0);'>总数："+totalCount+"</a>";
        $("#pageList").html(pageHtml);
    }

    function sendRequest(pageFlag,page,totalPage){
        if(pageFlag == "next"){
            page++;
        }else{
            if(pageFlag == "prev"){
                page--;
            }
        }

        if(page > 0 && page <= totalPage){
            var driverName = $("#driverName").val();
            var teamName = $("#teamName").val();
            var carPlateNum = $("#carPlateNum").val();
            var driverPhone = $("#driverPhone").val();
            var driverIdCard = $("#driverIdCard").val();
            var param = {
                'queryObj.driverName':driverName,
                'queryObj.teamName':teamName,
                'queryObj.carPlateNum':carPlateNum,
                'queryObj.driverPhone':driverPhone,
                'queryObj.driverIdCard':driverIdCard,
                'page':page,
                'limit':13
            }
            searchEmpList(param);
        }
    }

    function searchEmpType(empType){
        var empTypeHZ = "";
        if(empType == "0"){
            empTypeHZ = "其他";
        }
        if(empType == "1"){
            empTypeHZ = "驾驶员";
        }
        if(empType == "2"){
            empTypeHZ = "押运员";
        }
        if(empType == "3"){
            empTypeHZ = "装卸员";
        }
        if(empType == "4"){
            empTypeHZ = "经理";
        }
        if(empType == "5"){
            empTypeHZ = "财务";
        }
        if(empType == "6"){
            empTypeHZ = "业务";
        }
        if(empType == "7"){
            empTypeHZ = "内勤";
        }
        return empTypeHZ;
    }

    function goShouYe() {
        window.location.href = "../bigdata/shouye.html";
    }
</script>

    
  
</body>
</html>
